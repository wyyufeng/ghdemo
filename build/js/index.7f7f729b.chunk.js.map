{"version":3,"sources":["webpack:///./src/app/index.js"],"names":["width","window","innerWidth","height","innerHeight","container","document","body","center","app","PIXI","antialias","backgroundColor","appendChild","view","linkGh","stage","addChild","i","log","Popup","this","gh","position","Vector","Node","id","index","v","a","mass","fx","undefined","fy","force","add","devideScalar","Link","target","source","length","x","y","s","Math","sqrt","ForceLayout","nodes","links","circles","nodesMap","Map","linksMap","onTick","initLayout","ke","stats","Stats","showPanel","getElementById","dom","prototype","addNodes","push","map","node","addLinks","link","t","find","n","start","self","forEach","random","set","c","basicText","fill","beginFill","arc","PI","endFill","interactive","on","onDragStart","onDragEnd","onDragMove","e","console","dragging","newPosition","data","getLocalPosition","parent","createBigCircle","requestAnimationFrame","step","begin","tick","end","pos","p","clone","sub","distance","normalize","addScalar","lineStyle","drawCircle","popup","txt","ins","removeChild","splice","findIndex","updateCoulombsLaw","updateHooksLaw","updateCircles","update","j","circle","f","multiplyScalar","l","ni","nj","f1","f2","dir","interpolation","calcKE","clear","moveTo","lineTo","pow","event","alpha","presing","layout","test"],"mappings":"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","file":"js/index.7f7f729b.chunk.js","sourcesContent":["/* eslint-disable no-unused-vars */\n/* eslint-disable no-debugger */\nimport * as PIXI from 'pixi.js';\nimport Stats from 'stats.js';\nimport data from '../assets/graph.json';\n\nconst width = window.innerWidth;\nconst height = window.innerHeight;\nconst container = document.body;\nconst center = {\n    x: width * 0.5,\n    y: height * 0.5\n};\nconst app = new PIXI.Application({\n    width,\n    height,\n    antialias: true,\n    backgroundColor: 0x00173d\n});\ncontainer.appendChild(app.view);\nconst linkGh = new PIXI.Graphics();\napp.stage.addChild(linkGh);\nconst _log = log();\n\nclass Popup {\n    constructor() {\n        this.gh = null;\n        this.position = new Vector();\n    }\n}\n\nclass Node {\n    constructor(id, index) {\n        this.index = index;\n        this.id = id;\n        this.position = new Vector();\n        this.v = new Vector(); // 速度\n        this.a = new Vector(); // 加速度\n        this.mass = 1;\n        this.fx = undefined;\n        this.fy = undefined;\n    }\n    applyForce(force) {\n        this.a.add(force.devideScalar(this.mass));\n    }\n}\n\nclass Link {\n    constructor(target, source) {\n        this.target = target;\n        this.source = source;\n        this.length = 100;\n    }\n}\nclass Vector {\n    constructor(x, y) {\n        this.x = x || 0;\n        this.y = y || 0;\n    }\n    set(x, y) {\n        this.x = x;\n        this.y = y;\n        return this;\n    }\n    add(v) {\n        this.x += v.x;\n        this.y += v.y;\n        return this;\n    }\n    sub(v) {\n        this.x -= v.x;\n        this.y -= v.y;\n        return this;\n    }\n    multiplyScalar(s) {\n        this.x *= s;\n        this.y *= s;\n        return this;\n    }\n    devideScalar(s) {\n        this.x /= s;\n        this.y /= s;\n        return this;\n    }\n    length() {\n        return Math.sqrt(this.x ** 2 + this.y ** 2);\n    }\n    normalize() {\n        return this.devideScalar(this.length());\n    }\n    clone() {\n        return new Vector(this.x, this.y);\n    }\n    addScalar(s) {\n        this.x += s;\n        this.y += s;\n        return this;\n    }\n}\nfunction ForceLayout() {\n    this.nodes = [];\n    this.links = [];\n    this.circles = [];\n    this.nodesMap = new Map();\n    this.linksMap = new Map();\n    this.onTick = () => {};\n    this.initLayout = () => {};\n    this.ke = 0;\n    this.stats = new Stats();\n    this.stats.showPanel(0); // 0: fps, 1: ms, 2: mb, 3+: custom\n    document.getElementById('app').appendChild(this.stats.dom);\n    // console.log(this.stats);\n}\n\nForceLayout.prototype = {\n    addNodes(nodes) {\n        this.nodes.push(...nodes.map((node, index) => new Node(node.id, index)));\n    },\n    addLinks(links) {\n        this.links.push(\n            ...links.map((link, index) => {\n                const t = this.nodes.find((n) => n.index === link.target);\n                const s = this.nodes.find((n) => n.index === link.source);\n                return new Link(t, s);\n            })\n        );\n    },\n    start() {\n        const self = this;\n        this.nodes.forEach((node) => {\n            const x = center.x + 100 * (Math.random() - 0.5);\n            const y = center.y + 100 * (Math.random() - 0.5);\n            node.position.set(x, y);\n            const c = new PIXI.Container();\n            const gh = new PIXI.Graphics();\n            const basicText = new PIXI.Text(\n                node.id,\n                new PIXI.TextStyle({\n                    fill: 0xffffff\n                })\n            );\n\n            c.addChild(basicText);\n            gh.beginFill(0xff0000);\n            gh.arc(0, 0, 20, 0, Math.PI * 2);\n            gh.endFill();\n            gh.node = node;\n            c.node = node;\n            // gh.interactive = true;\n            c.interactive = true;\n            c.on('pointerdown', this.onDragStart)\n                .on('pointerup', this.onDragEnd)\n                .on('pointerupoutside', this.onDragEnd)\n                .on('pointermove', this.onDragMove)\n                .on('click', function(e) {\n                    console.log(this.dragging);\n                    if (this.dragging) return;\n                    const newPosition = e.data.getLocalPosition(this.parent);\n                    self.createBigCircle(newPosition);\n                });\n            c.position.set(node.position.x, node.position.y);\n            node.gh = gh;\n            node.c = c;\n            c.addChild(gh);\n            app.stage.addChild(c);\n        });\n\n        this.initLayout();\n        window.requestAnimationFrame(function step() {\n            self.stats.begin();\n\n            self.tick();\n\n            requestAnimationFrame(step);\n            self.ke = 0;\n            self.stats.end();\n        });\n    },\n    createBigCircle(pos) {\n        const p = new Vector(pos.x, pos.y);\n        for (let i = 0; i < this.circles.length; i++) {\n            const circle = this.circles[i];\n            const v = circle.position.clone().sub(p);\n            const distance = v.length();\n            if (distance <= 200) {\n                p.add(v.normalize().addScalar(100 - distance));\n            }\n        }\n\n        const gh = new PIXI.Graphics();\n        gh.lineStyle(0); // draw a circle, set the lineStyle to zero so the circle doesn't have an outline\n        gh.beginFill(0xde3249, 1);\n        gh.drawCircle(0, 0, 100);\n        gh.endFill();\n        const basicText = new PIXI.Text(\n            '点击关闭',\n            new PIXI.TextStyle({\n                fill: 0xffffff\n            })\n        );\n\n        basicText.position.set(p.x, p.y);\n        const popup = new Popup();\n        popup.gh = gh;\n        gh.popup = popup;\n        popup.txt = basicText;\n        gh.position.set(p.x, p.y);\n        popup.position.set(p.x, p.y);\n        this.circles.push(popup);\n\n        gh.interactive = true;\n        gh.on('click', (e) => {\n            const target = e.target;\n            const ins = target.popup;\n            app.stage.removeChild(ins.gh, ins.txt);\n            this.circles.splice(\n                this.circles.findIndex((i) => i === ins),\n                1\n            );\n        });\n\n        app.stage.addChild(gh);\n        app.stage.addChild(basicText);\n    },\n    tick() {\n        const self = this;\n        for (let i = 0; i < 2; i++) {\n            self.updateCoulombsLaw();\n            self.updateHooksLaw();\n        }\n        self.updateCircles();\n        self.update();\n        self.onTick();\n    },\n    updateCircles() {\n        for (let i = 0; i < this.nodes.length; i++) {\n            for (let j = 0; j < this.circles.length; j++) {\n                const node = this.nodes[i];\n                const circle = this.circles[j];\n                const distance = Math.sqrt(\n                    (node.position.x - circle.position.x) ** 2 +\n                        (node.position.y - circle.position.y) ** 2\n                );\n                if (distance < 120) {\n                    const v = node.position.clone().sub(circle.position);\n                    const dir = v.normalize();\n                    const f = dir.multiplyScalar(2);\n                    node.a.add(f);\n                }\n            }\n        }\n    },\n    updateCoulombsLaw() {\n        const l = this.nodes.length;\n        for (let i = 0; i < l; i++) {\n            for (let j = i + 1; j < l; j++) {\n                if (i === j) continue;\n\n                const ni = this.nodes[i];\n                const nj = this.nodes[j];\n                const v = ni.position.clone().sub(nj.position);\n                const distance = v.length();\n                const dir = v.normalize();\n\n                const f1 = dir.multiplyScalar(400).multiplyScalar(1 / distance ** 2);\n                const f2 = f1.clone().multiplyScalar(-1);\n                // console.log(f1, f2);\n                ni.a.add(f1);\n                nj.a.add(f2);\n            }\n        }\n    },\n    updateHooksLaw() {\n        const l = this.links.length;\n        for (let i = 0; i < l; i++) {\n            const link = this.links[i];\n            const { source, target, length } = link;\n            const v = source.position.clone().sub(target.position);\n            const dir = v.clone().normalize();\n            const interpolation = length - v.length();\n            const f1 = dir.multiplyScalar(interpolation * 0.01);\n            const f2 = f1.clone().multiplyScalar(-1);\n            // _log(v, dir, interpolation, f1, f2);\n            source.a.add(f1);\n            target.a.add(f2);\n        }\n    },\n\n    update() {\n        for (let i = 0, l = this.nodes.length; i < l; i++) {\n            const node = this.nodes[i];\n            node.v.add(node.a);\n            const clone = node.position.clone();\n            // node.position.add(node.v.multiplyScalar(0.8));\n            if (typeof node.fx !== 'undefined') {\n                node.position.x = node.fx;\n            } else {\n                node.position.x = clone.add(node.v.multiplyScalar(0.8)).x;\n            }\n            if (typeof node.fy !== 'undefined') {\n                node.position.y = node.fy;\n            } else {\n                node.position.y = clone.add(node.v.multiplyScalar(0.8)).y;\n            }\n            node.a.set(0, 0);\n            this.calcKE(node);\n        }\n        linkGh.clear();\n        for (let i = 0, l = this.links.length; i < l; i++) {\n            const link = this.links[i];\n            const { target, source } = link;\n            linkGh.lineStyle(2, 0xffffff);\n            linkGh.moveTo(source.position.x, source.position.y);\n            linkGh.lineTo(target.position.x, target.position.y);\n        }\n        // linkGh.endFill();\n        // console.log(this.ke);\n    },\n    calcKE(node) {\n        // console.log(node.v.length());\n        this.ke += 0.5 * node.mass * Math.pow(node.v.length(), 2);\n        // console.log(this.ke);\n    },\n    onDragStart(event) {\n        this.data = event.data;\n        this.alpha = 0.5;\n        this.presing = true;\n        // this.dragging = true;\n    },\n    onDragEnd() {\n        console.log('onDragEnd');\n        this.alpha = 1;\n        this.dragging = false;\n        this.presing = false;\n        // set the interaction data to null\n        this.data = null;\n        this.node.fx = undefined;\n        this.node.fy = undefined;\n        this.node.a.set(0, 0);\n        this.node.v.set(0, 0);\n    },\n\n    onDragMove() {\n        // console.log(this);\n        if (this.presing) this.dragging = true;\n        if (this.dragging) {\n            const newPosition = this.data.getLocalPosition(this.parent);\n            this.node.fx = newPosition.x;\n            this.node.fy = newPosition.y;\n            // console.log(this);\n        }\n    }\n};\n\nfunction test() {\n    const layout = new ForceLayout();\n    layout.addNodes(data.nodes);\n    layout.addLinks(data.links);\n    layout.start();\n    layout.onTick = function() {\n        layout.nodes.forEach((node) => {\n            node.c.position.set(node.position.x, node.position.y);\n        });\n    };\n    // console.log(layout);\n}\ntest();\n\nfunction log() {\n    let i = 0;\n    return (...args) => {\n        if (i > 100) return;\n        console.log(...args);\n        i++;\n    };\n}\n"],"sourceRoot":""}